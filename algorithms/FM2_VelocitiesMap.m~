%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% [F, time] = FM2_VelocitiesMap(map, sat)
%
% Inputs:
%   + map: MxN logical matrix representing the environment map as a binary 
%   occupancy gridmap, 0 (black) are obstacles and 1 (white) free space.

%   + sat: double scalar for the saturation v

function [F, time] = FM2_VelocitiesMap(map, sat)

tic();
if sat > 0
    F = rescale( double(map) );
    [row,col]=find(F<0.5); %Getting obstacles.
    start_points = [row,col]';

    options.nb_iter_max = Inf;
    options.Tmax = sum(size(F));
    [F,~] = perform_fast_marching(F, start_points, options);

    F = rescale(min(rescale(F), sat));
else
    F = double(map);
end
time = toc();

end

